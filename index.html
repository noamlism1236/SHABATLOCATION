<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>זמני שבת</title>
    <script>
        async function fetchShabbatTimes() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(async position => {
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;
                    const apiUrl = `https://www.hebcal.com/shabbat?cfg=json&latitude=${lat}&longitude=${lon}&m=50`;
                    
                    try {
                        const response = await fetch(apiUrl);
                        const data = await response.json();
                        displayShabbatTimes(data);
                    } catch (error) {
                        document.getElementById("times").innerHTML = "שגיאה בקבלת הנתונים";
                    }
                }, () => {
                    document.getElementById("times").innerHTML = "לא ניתן להשיג מיקום";
                });
            } else {
                document.getElementById("times").innerHTML = "המכשיר שלך לא תומך בגיאולוקציה";
            }
        }
        
        function displayShabbatTimes(data) {
            let shabbatEvents = data.items.filter(event => event.category === "candles" || event.category === "havdalah");
            let resultHtml = "<h3>זמני שבת:</h3>";
            shabbatEvents.forEach(event => {
                let dateTime = new Date(event.date);
                let formattedTime = dateTime.toLocaleTimeString("he-IL", { hour: "2-digit", minute: "2-digit" });
                resultHtml += `<p>${event.title}: ${formattedTime}</p>`;
            });
            document.getElementById("times").innerHTML = resultHtml;
        }
    </script>
</head>
<body>
    <h1>זמני שבת הקרובים</h1>
    <button onclick="fetchShabbatTimes()">הצג</button>
    <div id="times"></div>
</body>
</html>
